# Media-streaming scenario: audio, video, and WebSocket streaming endpoints.
# Tests the DUT's media playback and real-time data capabilities.

config:
  files_dir: /opt/jumpstarter/mitmproxy/mock-files
  addons_dir: /opt/jumpstarter/mitmproxy/addons

endpoints:
  GET /api/v1/status:
    status: 200
    body: {id: device-001, status: active}

  GET /streaming/audio/channel/*:
    addon: hls_audio_stream
    addon_config:
      segments_dir: audio/segments
      segment_duration_s: 6
      channels:
        ch101: {name: Classic Rock, bitrate: 128000}
        ch202: {name: Jazz Classics, bitrate: 256000}
        ch305: {name: News Talk, bitrate: 64000}

  GET /streaming/video/camera/*:
    addon: mjpeg_stream
    addon_config:
      frames_dir: video/frames
      fps: 15
      default_resolution: [640, 480]
      cameras:
        rear: {frames_dir: video/rear}
        front: {frames_dir: video/front}
        surround: {frames_dir: video/surround}

  WEBSOCKET /api/v1/data/realtime:
    addon: data_stream_websocket
    addon_config:
      push_interval_ms: 100
      scenario: normal

  GET /api/v1/media/album-art/*:
    status: 200
    file: images/default-album-art.jpg
    content_type: image/jpeg

  GET /api/v1/media/now-playing:
    status: 200
    body_template:
      title: "{{random_choice('Hotel California', 'Bohemian Rhapsody', 'Take Five')}}"
      artist: "{{random_choice('Eagles', 'Queen', 'Dave Brubeck')}}"
      channel: ch101
      position_s: "{{random_int(0, 300)}}"
      duration_s: 300
      album_art_url: /api/v1/media/album-art/current.jpg
